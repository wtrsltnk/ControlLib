// List.cpp: implementation of the CWList class.
//
//////////////////////////////////////////////////////////////////////

#include "stdafx.h"

//////////////////////////////////////////////////////////////////////
// Construction/Destruction
//////////////////////////////////////////////////////////////////////

CWList::CWList()
{
	this->m_dwStyle			= WS_CHILD | WS_VISIBLE | LBS_NOTIFY;
	this->m_strClassName	= "LISTBOX";
    strcpy(this->m_strTitle, "Titel");
}

CWList::~CWList()
{
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
int CWList::AddItem(char item[], int index, DWORD data)
{
	int i = SendMessage(m_hWnd, LB_ADDSTRING, 0, (LPARAM)(LPCTSTR)item);
	
	if (data)
		SendMessage(m_hWnd, LB_SETITEMDATA, (WPARAM)i, (LPARAM)data);

	return i;
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
bool CWList::RemoveItem(int index)
{
	return SendMessage(m_hWnd, LB_DELETESTRING, (WPARAM)index, 0) != CB_ERR;
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
char* CWList::GetText(int index)
{
	char* text;

	int len = SendMessage(m_hWnd, LB_GETTEXTLEN, (WPARAM)index, 0);
	text = new char[len];
	SendMessage(m_hWnd, LB_GETTEXT, (WPARAM)index, (LPARAM)(LPCTSTR)text);
	return text;
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
DWORD CWList::GetData(int index)
{
	return (DWORD)SendMessage(m_hWnd, LB_GETITEMDATA, (WPARAM)index, 0);
}

///////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
int CWList::GetSelectedIndex()
{
	return SendMessage(m_hWnd, LB_GETCURSEL, 0, 0);
}

///////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
void CWList::Clear()
{
	SendMessage(m_hWnd, LB_RESETCONTENT, 0, 0);
}

///////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
void CWList::Select(int index)
{
	SendMessage(m_hWnd, LB_SETCURSEL, (WPARAM)index, 0);
}
