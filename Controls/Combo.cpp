// Combo.cpp: implementation of the CWCombo class.
//
//////////////////////////////////////////////////////////////////////

#include "stdafx.h"

//////////////////////////////////////////////////////////////////////
// Construction/Destruction
//////////////////////////////////////////////////////////////////////

CWCombo::CWCombo()
{
	this->m_dwStyle			= WS_CHILD | WS_VISIBLE | CBS_DROPDOWN;
	this->m_strClassName	= "COMBOBOX";
	this->m_strTitle		= "Combobox";
}

CWCombo::~CWCombo()
{
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
int CWCombo::AddItem(char item[], int index, DWORD data)
{
	int i = SendMessage(m_hWnd, CB_INSERTSTRING, (WPARAM)index, (LPARAM)(LPCTSTR)item);
	
	if (data)
		SendMessage(m_hWnd, CB_SETITEMDATA, (WPARAM)i, (LPARAM)data);

	return i;
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
bool CWCombo::RemoveItem(int index)
{
	return SendMessage(m_hWnd, CB_DELETESTRING, (WPARAM)index, 0) != CB_ERR;
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
char* CWCombo::GetText(int index)
{
	char* text;

	int len = SendMessage(m_hWnd, CB_GETLBTEXTLEN, (WPARAM)index, 0);
	text = new char[len];
	SendMessage(m_hWnd, CB_GETLBTEXT, (WPARAM)index, (LPARAM)(LPCTSTR)text);
	return text;
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
DWORD CWCombo::GetData(int index)
{
	return SendMessage(m_hWnd, CB_GETITEMDATA, (WPARAM)index, 0);
}

///////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
int CWCombo::GetSelectedIndex()
{
	return SendMessage(m_hWnd, CB_GETCURSEL, 0, 0);
}

///////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
void CWCombo::Clear()
{
	SendMessage(m_hWnd, CB_RESETCONTENT, 0, 0);
}

///////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
void CWCombo::Select(int index)
{
	SendMessage(m_hWnd, CB_SETCURSEL, (WPARAM)index, 0);
}