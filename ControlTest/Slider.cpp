// Slider.cpp: implementation of the CSlider class.
//
//////////////////////////////////////////////////////////////////////

#include "stdafx.h"

//////////////////////////////////////////////////////////////////////
// Construction/Destruction
//////////////////////////////////////////////////////////////////////

CWSlider::CWSlider()
{
	this->m_dwStyle			= WS_CHILD | WS_VISIBLE;
	this->m_strClassName	= "msctls_trackbar32";
	this->m_strTitle		= "Titel";
}

CWSlider::~CWSlider()
{
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
void CWSlider::Init(int min, int max)
{
	SendMessage(m_hWnd, TBM_SETRANGE, 
        (WPARAM) TRUE,                   // redraw flag 
        (LPARAM) MAKELONG(min, max));  // min. & max. positions 

    SendMessage(m_hWnd, TBM_SETPAGESIZE, 
        0, (LPARAM) 4); 

    SendMessage(m_hWnd, TBM_SETPOS, 
        (WPARAM) TRUE,
        (LPARAM) 0); 
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
void CWSlider::Reset()
{
	SendMessage( m_hWnd, TVM_DELETEITEM, 0, (LPARAM) TVI_ROOT );
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
void CWSlider::SetSel(int sel)
{
	SendMessage( m_hWnd, TBM_SETPOS, (WPARAM) (BOOL) TRUE, (LPARAM) (LONG)sel );
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
int CWSlider::GetSel()
{
	return SendMessage( m_hWnd, TBM_GETPOS, (WPARAM)0, (LPARAM)0 );
}

////////////////////////////////////////////////////////////////////////////////
/// Purpose : 
/// Input   : 
/// Output  : 
////////////////////////////////////////////////////////////////////////////////
bool CWSlider::CompareHandle(HWND hWnd)
{
	return (hWnd == m_hWnd);
}